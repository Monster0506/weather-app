<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Weather App - {{ weather.city }}</title>

    <!-- Bootstrap CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <!-- Font Awesome for icons -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />

    <style>
      body {
        font-family: Arial, sans-serif;
        background-color: #f0f8ff;
        color: #333;
        padding: 20px;
      }
      h1 {
        color: #4caf50;
      }
      .weather-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
        background-color: #fff;
        border-radius: 10px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      }
      .weather-data div {
        margin-bottom: 10px;
      }
      .sunrise-icon,
      .sunset-icon {
        font-size: 24px;
        color: #f39c12;
        animation: rise-set-animation 2s infinite alternate;
      }
      @keyframes rise-set-animation {
        from {
          transform: translateY(0);
        }
        to {
          transform: translateY(-10px);
        }
      }
      /* Sun and moon gradients */

      /* Define key gradient colors */
      .sunrise-gradient {
        background: linear-gradient(
          135deg,
          #ffcf71,
          #ff8a71
        ); /* Soft orange and pink */
      }

      .midday-gradient {
        background: linear-gradient(
          135deg,
          #87cefa,
          #ffd700
        ); /* Blue and yellow */
      }

      .sunset-gradient {
        background: linear-gradient(
          135deg,
          #ff512f,
          #dd2476
        ); /* Deep oranges and purples */
      }

      .night-gradient {
        background: linear-gradient(
          135deg,
          #2c3e50,
          #34495e
        ); /* Deep blues and dark purples */
      }

      /* Animate background transitions */
      .dynamic-gradient {
        transition: background 1s ease-in-out;
      }
      /* Cloud cover animation */
      .cloud-icon {
        font-size: 24px;
        color: #7f8c8d;
        transition: opacity 1s ease-in-out;
      }

      /* Visibility animation */
      .eye-icon {
        font-size: 24px;
        color: #3498db;
        transition: opacity 1s ease-in-out;
      }

      /* Wind direction arrow */
      .wind-arrow {
        font-size: 24px;
        color: #2ecc71;
        transition: transform 1s ease-in-out;
      }

      /* Gust speed animation */
      .gust-icon {
        font-size: 24px;
        color: #e74c3c;
        animation: gust-animation 2s infinite alternate;
      }
      @keyframes gust-animation {
        from {
          transform: translateX(0);
        }
        to {
          transform: translateX(20px);
        }
      }
    </style>
  </head>
  <body id="weather-body">
    <div class="weather-container">
      <h1 class="text-center">
        Weather in {{ weather.city }}, {{ weather.country }}
      </h1>

      <div class="text-center mb-4">
        <!-- Weather Condition Icon -->
        <img src="{{ weather.weather_icon }}" alt="Weather Condition Icon" />
        <div><strong>Condition:</strong> {{ weather.weather_description }}</div>
      </div>

      <div class="row mt-4">
        <div class="col-md-6">
          <div><strong>Temperature:</strong> {{ weather.temperature }} °C</div>
          <div><strong>Feels Like:</strong> {{ weather.feels_like }} °C</div>
          <div><strong>Min Temp:</strong> {{ weather.min_temp }} °C</div>
          <div><strong>Max Temp:</strong> {{ weather.max_temp }} °C</div>
        </div>
        <div class="col-md-6">
          <div><strong>Pressure:</strong> {{ weather.pressure }} hPa</div>
          <div><strong>Humidity:</strong> {{ weather.humidity }}%</div>
          <div>
            <strong>Visibility:</strong> <i class="fas fa-eye eye-icon"></i> {{
            weather.visibility }} meters
          </div>
        </div>
      </div>

      <div class="row mt-4">
        <div class="col-md-6">
          <div>
            <strong>Wind Speed:</strong>
            {{ weather.wind_speed }} m/s<i class="fas fa-wind gust-icon"></i>
          </div>
          <div>
            <strong>Wind Direction:</strong>
            <i
              class="fas fa-arrow-up wind-arrow"
              style="transform: rotate({{ weather.wind_deg }}deg);"
            ></i>
            {{ weather.wind_deg }}°
          </div>
          <div>
            <strong>Cloud Cover:</strong>
            <i class="fas fa-cloud cloud-icon"></i> {{ weather.clouds }}%
          </div>
        </div>
        <div class="col-md-6 text-center">
          <div>
            <i class="fas fa-sun sunrise-icon"></i><strong>Sunrise:</strong> {{
            weather.sunrise }}
          </div>

          <div>
            <i class="fas fa-moon sunset-icon"></i><strong>Sunset:</strong> {{
            weather.sunset }}
          </div>
        </div>
      </div>

      <div class="text-center mt-4">
        <a href="/" class="btn btn-primary">Search Again</a>
      </div>
    </div>

    <!-- Bootstrap and JS dependencies -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JavaScript to handle animations based on weather conditions -->
    <script>
      document.addEventListener('DOMContentLoaded', function() {
          const cloudIcon = document.querySelector('.cloud-icon');
          const eyeIcon = document.querySelector('.eye-icon');

          // Cloud cover opacity based on percentage
          const cloudCover = {{ weather.clouds }};
          cloudIcon.style.opacity = cloudCover / 100;

          // Visibility - if visibility is low, fade out the eye icon
          const visibility = {{ weather.visibility }};
          eyeIcon.style.opacity = visibility / 10000;

          const weatherBody = document.getElementById('weather-body');

          const currentTime = new Date().getTime() / 1000;  // Current time in seconds (Unix timestamp)
          const sunrise = {{ weather.sunrise_time }};       // Unix timestamp for sunrise
          const sunset = {{ weather.sunset_time }};         // Unix timestamp for sunset

          const dayDuration = sunset - sunrise;             // Total duration of the day in seconds
          const timeOfDay = currentTime - sunrise;          // Current time relative to sunrise

          // Calculate percentage of the day that has passed
          let dayProgress = timeOfDay / dayDuration;

          // Clamp dayProgress between 0 and 1 to handle edge cases
          dayProgress = Math.max(0, Math.min(1, dayProgress));

          // Apply gradient based on time of day
          if (currentTime < sunrise || currentTime > sunset) {
              // Nighttime: Apply night gradient
              weatherBody.classList.add('night-gradient');
          } else if (dayProgress < 0.33) {
              // Morning (Sunrise to Midday)
              weatherBody.classList.add('sunrise-gradient');
          } else if (dayProgress >= 0.33 && dayProgress < 0.66) {
              // Midday (Bright Day)
              weatherBody.classList.add('midday-gradient');
          } else {
              // Evening (Sunset)
              weatherBody.classList.add('sunset-gradient');
          };
            });
    </script>
  </body>
</html>
